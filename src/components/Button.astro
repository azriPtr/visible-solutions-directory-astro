---
interface Props {
  text?: string;

  variant?: "primary" | "secondary" | "outline" | "text" | "ghost";

  size?: "sm" | "md" | "lg" | "xl";

  // States
  disabled?: boolean;
  loading?: boolean;

  fullWidth?: boolean;

  // Icons (using Iconify format: icon-[tabler--icon-name])
  iconLeft?: string;
  iconRight?: string;

  href?: string;
  type?: "button" | "submit" | "reset";
  target?: "_blank" | "_self";

  class?: string;
}

const {
  text,
  variant = "primary",
  size = "md",
  disabled = false,
  loading = false,
  fullWidth = false,
  iconLeft,
  iconRight,
  href,
  type = "button",
  target = "_self",
  class: className = "",
} = Astro.props;

// Base button classes - added leading-none for better vertical centering
const baseClasses =
  "btn inline-flex items-center justify-center gap-2 font-bold transition-all leading-none";

// Variant classes
const variantClasses = {
  primary: "btn-primary",
  secondary: "btn-secondary",
  outline: "btn-outline btn-primary",
  text: "btn-text btn-primary",
  ghost: "btn-ghost",
};

// Size classes - adjusted to match input heights
// sm: ~40px (h-10), md: ~44px (h-11), lg: ~48px (h-12), xl: ~56px (h-14)
const sizeClasses = {
  sm: "h-10 px-4 text-xs",
  md: "h-11 px-6 text-sm",
  lg: "h-12 px-6 text-base btn-lg",
  xl: "h-14 px-8 text-base",
};

// Build final class string
const buttonClasses = [
  baseClasses,
  variantClasses[variant],
  sizeClasses[size],
  fullWidth ? "w-full md:w-auto" : "",
  disabled || loading ? "opacity-60 cursor-not-allowed" : "",
  className,
]
  .filter(Boolean)
  .join(" ");

// Determine if we should render as link or button
const Element = href ? "a" : "button";

// Additional props for links
const linkProps = href
  ? {
      href,
      target,
      ...(target === "_blank" ? { rel: "noopener noreferrer" } : {}),
    }
  : {};

// Additional props for buttons
const buttonProps = !href
  ? {
      type,
      disabled: disabled || loading,
    }
  : {};
---

<Element class={buttonClasses} {...linkProps} {...buttonProps}>
  {loading && <span class="loading loading-spinner loading-xs" />}

  {!loading && iconLeft && <span class={`${iconLeft} shrink-0`} />}

  {text || <slot />}

  {!loading && iconRight && <span class={`${iconRight} shrink-0`} />}
</Element>
