---
import Layout from "../layouts/Layout.astro";
import Button from "../components/Button.astro";
import { getEntry } from "astro:content";

const entry = await getEntry("pages", "cookies");
if (!entry) {
  throw new Error("Cookie Policy content not found");
}

const { title, description, lastUpdated, policyVersion } = entry.data;

const seoData = {
  title: `${title} | UK Locksmith Directory`,
  description,
};
---

<Layout {...seoData}>
  <main class="bg-white py-16">
    <div class="mx-auto max-w-7xl px-6">
      <!-- Page Title -->
      <h1 class="mb-4 text-4xl font-bold text-primary">
        {title}
      </h1>

      <!-- Meta Information -->
      <div
        class="mb-6 flex flex-wrap gap-2 text-xs uppercase tracking-wide text-base-content/40">
        <span>Last updated: {lastUpdated}</span>
        <span>â€¢</span>
        <span>Policy version: {policyVersion}</span>
      </div>

      <!-- Introduction Paragraph -->
      <p class="mb-12 leading-relaxed text-base-content/70">
        {description}
      </p>

      <!-- Consent Notice Box -->
      <div class="mb-8 rounded-lg bg-info/10 p-6">
        <div class="flex items-start gap-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="mt-0.5 flex-shrink-0 text-info">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 16v-4"></path>
            <path d="M12 8h.01"></path>
          </svg>
          <div>
            <h3 class="mb-2 text-sm font-bold text-base-content">
              Consent Notice
            </h3>
            <p class="text-sm leading-relaxed text-base-content/70">
              Non-essential cookies (Analytics, Marketing) are not activated
              until you explicitly provide consent via our cookie banner.
            </p>
          </div>
        </div>
      </div>

      <!-- Table of Contents -->
      <section class="mb-12">
        <details
          class="group rounded-lg border border-base-200 bg-white p-6 shadow-sm">
          <summary
            class="flex cursor-pointer items-center justify-between text-base font-bold text-base-content">
            <span>Table of Contents</span>
            <svg
              class="h-5 w-5 transition-transform group-open:rotate-180"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
        </details>
      </section>

      <!-- Main Content -->
      <article class="mb-16">
        <!-- Section 1: What cookies are -->
        <h2 class="mb-6 text-2xl font-bold text-primary">
          1. What cookies are
        </h2>

        <p class="mb-6 leading-relaxed text-base-content/70">
          Cookies are small text files placed on your device when you visit a
          website. They allow the site to recognize your device and store
          information about your preferences or past actions.
        </p>

        <div class="mb-6 space-y-4">
          <div>
            <h3 class="mb-2 text-base font-bold text-base-content">
              First-party cookies
            </h3>
            <p class="text-sm leading-relaxed text-base-content/70">
              are set directly by the website you are visiting (UK Locksmith
              Directory).
            </p>
          </div>

          <div>
            <h3 class="mb-2 text-base font-bold text-base-content">
              Third-party cookies
            </h3>
            <p class="text-sm leading-relaxed text-base-content/70">
              are set by a domain other than the one you are visiting, primarily
              for our analytics and marketing partners.
            </p>
          </div>

          <div>
            <h3 class="mb-2 text-base font-bold text-base-content">
              Session cookies
            </h3>
            <p class="text-sm leading-relaxed text-base-content/70">
              expire once you close your web browser.
            </p>
          </div>

          <div>
            <h3 class="mb-2 text-base font-bold text-base-content">
              Persistent cookies
            </h3>
            <p class="text-sm leading-relaxed text-base-content/70">
              stay on your device for a set period or until you delete them.
            </p>
          </div>
        </div>

        <hr class="my-12 border-base-200" />

        <!-- Section 2: Categories of cookies we use -->
        <h2 class="mb-6 text-2xl font-bold text-primary">
          2. Categories of cookies we use
        </h2>

        <div class="space-y-4">
          <!-- Strictly Necessary -->
          <div class="rounded-lg border border-base-200 bg-white p-6">
            <div class="mb-3 flex items-center gap-3">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-base-content/60">
                <rect width="18" height="11" x="3" y="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
              <h3 class="text-base font-bold text-base-content">
                Strictly Necessary
              </h3>
            </div>
            <p class="text-sm leading-relaxed text-base-content/70">
              These cookies are essential for the website to function correctly.
              They enable core security features, load routing state management,
              and accessibility preferences. You cannot switch these off in our
              systems.
            </p>
          </div>

          <!-- Performance / Analytics -->
          <div class="rounded-lg border border-base-200 bg-white p-6">
            <div class="mb-3 flex items-center gap-3">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-base-content/60">
                <path d="M3 3v18h18"></path>
                <path d="m19 9-5 5-4-4-3 3"></path>
              </svg>
              <h3 class="text-base font-bold text-base-content">
                Performance / Analytics
              </h3>
            </div>
            <p class="text-sm leading-relaxed text-base-content/70">
              These allow us to count visits and traffic sources so we can
              measure and improve the performance of our site. They help us know
              which pages are the most and least popular and see how visitors
              move around the site (e.g., Google Analytics).
            </p>
          </div>

          <!-- Functional -->
          <div class="rounded-lg border border-base-200 bg-white p-6">
            <div class="mb-3 flex items-center gap-3">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-base-content/60">
                <path
                  d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"
                ></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
              <h3 class="text-base font-bold text-base-content">Functional</h3>
            </div>
            <p class="text-sm leading-relaxed text-base-content/70">
              These enable the website to provide enhanced functionality and
              personalization, such as remembering your detected location or
              language settings.
            </p>
          </div>

          <!-- Marketing / Attribution -->
          <div class="rounded-lg border border-base-200 bg-white p-6">
            <div class="mb-3 flex items-center gap-3">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="text-base-content/60">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
              <h3 class="text-base font-bold text-base-content">
                Marketing / Attribution
              </h3>
            </div>
            <p class="text-sm leading-relaxed text-base-content/70">
              Used to measure the effectiveness of our US-based marketing
              campaigns. These cookies may be set through our site by our
              advertising partners to build a profile of your interests and show
              you relevant adverts on other sites.
            </p>
          </div>
        </div>

        <hr class="my-12 border-base-200" />

        <!-- Section 3: How consent works -->
        <h2 class="mb-6 text-2xl font-bold text-primary">
          3. How consent works
        </h2>

        <p class="mb-4 leading-relaxed text-base-content/70">
          We operate a "Hard Opt-in" model for all non-essential cookies. This
          means:
        </p>

        <div class="mb-6 space-y-3 pl-6">
          <div>
            <span class="font-bold text-base-content">No tracking occurs</span>
            <span class="text-base-content/70">
              before you interact with our consent banner.
            </span>
          </div>
          <div>
            <span class="font-bold text-base-content">Active consent</span>
            <span class="text-base-content/70">
              is required for Analytics, Functional, and Marketing cookies.
            </span>
          </div>
          <div>
            <span class="font-bold text-base-content">Withdrawal</span>
            <span class="text-base-content/70">
              of consent is available at any time through this page or the
              consent manager.
            </span>
          </div>
        </div>

        <hr class="my-12 border-base-200" />

        <!-- Section 4: Managing your preferences -->
        <h2 class="mb-6 text-2xl font-bold text-primary">
          4. Managing your preferences
        </h2>

        <p class="mb-6 leading-relaxed text-base-content/70">
          You can change your cookie preferences at any time by clicking the
          button below. This will reopen the consent banner, allowing you to
          enable or disable specific categories of cookies.
        </p>

        <div class="mb-4 flex justify-center">
          <Button
            variant="primary"
            size="lg"
            iconLeft="icon-[tabler--settings]">
            Update cookie preferences
          </Button>
        </div>

        <p class="text-center text-sm text-base-content/50">
          Updates typically take effect immediately upon saving your choices.
        </p>
      </article>
    </div>
  </main>
</Layout>
