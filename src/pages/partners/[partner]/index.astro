---
import Layout from "../../../layouts/Layout.astro";
import Button from "../../../components/Button.astro";
import { getAllPartnerSlugs, getPartnerBySlug } from "../../../data/partners";

// Generate static paths for all partners
export async function getStaticPaths() {
  const slugs = getAllPartnerSlugs();
  return slugs.map((slug) => ({
    params: { partner: slug },
  }));
}

// Get the partner data
const { partner: partnerSlug } = Astro.params;
const partnerData = getPartnerBySlug(partnerSlug);

// 404 if partner not found
if (!partnerData) {
  return Astro.redirect("/404");
}

const seoData = {
  title: `${partnerData.name} | Partner | UK Locksmith Directory`,
  description: partnerData.description,
};

// Breadcrumbs
const breadcrumbs = [
  { label: "Home", href: "/" },
  { label: "Partners", href: "/partners" },
  { label: partnerData.name, href: `/partners/${partnerSlug}` },
];
---

<Layout {...seoData}>
  <div class="bg-base-50">
    <div class="mx-auto max-w-4xl px-4 sm:px-6">
      <!-- Breadcrumbs -->
      <nav aria-label="Breadcrumb" class="py-4">
        <ol class="flex items-center gap-2 text-sm text-base-content/60">
          {
            breadcrumbs.map((crumb, index) => (
              <li class="flex items-center gap-2">
                {index < breadcrumbs.length - 1 ? (
                  <a href={crumb.href} class="hover:text-primary">
                    {crumb.label}
                  </a>
                ) : (
                  <span aria-current="page" class="text-base-content">
                    {crumb.label}
                  </span>
                )}
                {index < breadcrumbs.length - 1 && (
                  <span aria-hidden="true">/</span>
                )}
              </li>
            ))
          }
        </ol>
      </nav>

      <!-- Hero Section -->
      <section class="py-12">
        <!-- Partner Logo/Icon -->
        <div class="mb-6 flex items-center gap-4">
          <div
            class="flex h-16 w-16 items-center justify-center rounded-lg border border-base-200 bg-white shadow-sm">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="32"
              height="32"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="text-primary">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"></path>
              <path d="m9 12 2 2 4-4"></path>
            </svg>
          </div>
          <div>
            <h1 class="text-3xl font-bold text-primary">
              {partnerData.name}
            </h1>
            <span class="mt-1 inline-block text-sm font-medium text-base-content/60">
              {partnerData.subtitle}
            </span>
          </div>
        </div>

        <!-- Description -->
        <p class="mb-6 max-w-3xl leading-relaxed text-base-content/80">
          {partnerData.description}
        </p>

        <!-- Verification Link -->
        <a
          href={partnerData.verificationLink}
          class="inline-flex items-center gap-1 text-sm font-semibold text-primary hover:underline">
          How partner verification works
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="size-4">
            <path d="M5 12h14"></path>
            <path d="m12 5 7 7-7 7"></path>
          </svg>
        </a>
      </section>

      <article class="pb-16">
        <!-- About Section -->
        <section class="mb-16">
          <h2 class="mb-6 text-2xl font-bold text-primary">
            {partnerData.about.title}
          </h2>
          <div class="space-y-4 leading-relaxed text-base-content/70">
            {partnerData.about.content.map((paragraph) => <p>{paragraph}</p>)}
          </div>
        </section>

        <!-- Why This Partnership Matters -->
        <section class="mb-16">
          <h2 class="mb-6 text-2xl font-bold text-primary">
            {partnerData.whyMatters.title}
          </h2>

          <p class="mb-6 leading-relaxed text-base-content/70">
            {partnerData.whyMatters.intro}
          </p>

          <ul class="space-y-3">
            {
              partnerData.whyMatters.benefits.map((benefit) => (
                <li class="flex gap-3">
                  <div class="flex-shrink-0">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="mt-0.5 text-success">
                      <circle cx="12" cy="12" r="10" />
                      <path d="m9 12 2 2 4-4" />
                    </svg>
                  </div>
                  <span class="text-base-content/70">{benefit.title}</span>
                </li>
              ))
            }
          </ul>
        </section>

        <!-- How Verification Works -->
        <section id="verification" class="mb-16">
          <h2 class="mb-6 text-2xl font-bold text-primary">
            {partnerData.verification.title}
          </h2>

          <p class="mb-6 leading-relaxed text-base-content/70">
            {partnerData.verification.intro}
          </p>

          <!-- Steps -->
          <div class="mb-6 grid gap-4 md:grid-cols-3">
            {
              partnerData.verification.steps.map((step) => (
                <div class="rounded-lg border border-base-200 bg-white p-6 text-center shadow-sm">
                  <div class="mb-2 text-sm font-semibold text-base-content/60">
                    Step {step.number}
                  </div>
                  <div class="mb-2 font-bold text-base-content">{step.title}</div>
                  {step.description && (
                    <p class="text-xs text-base-content/60">{step.description}</p>
                  )}
                </div>
              ))
            }
          </div>

          <!-- Note -->
          <p class="text-sm text-base-content/60">
            {partnerData.verification.note}
          </p>
        </section>

        <!-- Partner Badges & Search Ranking -->
        <section class="mb-16">
          <h2 class="mb-6 text-2xl font-bold text-primary">
            {partnerData.badgeLimitations.title}
          </h2>

          <p class="mb-6 leading-relaxed text-base-content/70">
            {partnerData.badgeLimitations.intro}
          </p>

          <div class="space-y-4">
            {
              partnerData.badgeLimitations.items.map((item) => (
                <div class="rounded-lg border border-base-200 bg-base-100 p-6">
                  <div class="mb-2 flex items-center gap-3">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        class="text-primary">
                        {item.icon === "trending-flat" ? (
                          <polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />
                        ) : item.icon === "clock" ? (
                          <>
                            <circle cx="12" cy="12" r="10" />
                            <polyline points="12 6 12 12 16 14" />
                          </>
                        ) : (
                          <>
                            <rect width="20" height="14" x="2" y="5" rx="2" />
                            <line x1="2" x2="22" y1="10" y2="10" />
                          </>
                        )}
                      </svg>
                    </div>
                    <h3 class="font-bold text-base-content">{item.title}</h3>
                  </div>
                  <p class="text-sm leading-relaxed text-base-content/70">
                    {item.description}
                  </p>
                </div>
              ))
            }
          </div>
        </section>

        <!-- FAQ Section -->
        <section class="mb-16">
          <h2 class="mb-6 text-2xl font-bold text-primary">
            Frequently asked questions
          </h2>

          <div class="space-y-4">
            {
              partnerData.faqs.map((faq) => (
                <details class="group rounded-lg border border-base-200 bg-white p-6 shadow-sm">
                  <summary class="flex cursor-pointer items-center justify-between font-bold text-base-content">
                    <span>{faq.question}</span>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="transition-transform group-open:rotate-180">
                      <path d="m6 9 6 6 6-6" />
                    </svg>
                  </summary>
                  <div class="mt-4 text-sm leading-relaxed text-base-content/70">
                    {faq.answer}
                  </div>
                </details>
              ))
            }
          </div>
        </section>

        <!-- External Reference -->
        <section class="mb-16">
          <div class="rounded-lg border border-base-200 bg-white p-8 text-center shadow-sm">
            <div class="mb-2 text-xs font-bold uppercase tracking-wide text-base-content/60">
              External Reference
            </div>
            <a
              href={partnerData.externalWebsite}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-2 text-lg font-semibold text-primary hover:underline">
              Visit {partnerData.name} website
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="size-5">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                <polyline points="15 3 21 3 21 9"></polyline>
                <line x1="10" x2="21" y1="14" y2="3"></line>
              </svg>
            </a>
          </div>
        </section>

        <!-- Back Navigation -->
        <section class="text-center">
          <Button
            href="/partners"
            variant="outline"
            size="md"
            iconLeft="icon-[tabler--arrow-left]">
            Back to all partners
          </Button>
        </section>
      </article>
    </div>
  </div>
</Layout>
