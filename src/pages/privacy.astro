---
import Layout from "../layouts/Layout.astro";
import PageHero from "../components/PageHero.astro";
import { getEntry } from "astro:content";

const entry = await getEntry("pages", "privacy");
if (!entry) {
  throw new Error("Privacy Policy content not found");
}

const { Content } = await entry.render();
const { title, description, lastUpdated, policyVersion, dataController } =
  entry.data;

const seoData = {
  title: `${title} | UK Locksmith Directory`,
  description,
};
---

<Layout {...seoData}>
  <main class="bg-white py-16">
    <div class="mx-auto max-w-4xl px-6">
      <!-- Page Title -->
      <h1 class="mb-4 text-4xl font-bold text-primary">
        {title}
      </h1>

      <!-- Meta Information -->
      <div
        class="mb-6 flex flex-wrap gap-2 text-xs uppercase tracking-wide text-base-content/40">
        <span>Last updated: {lastUpdated}</span>
        <span>•</span>
        <span>Policy version: {policyVersion}</span>
      </div>

      <!-- Introduction Paragraph -->
      <p class="mb-12 text-base leading-relaxed text-base-content/70">
        {description}
      </p>

      <!-- Data Controller Box -->
      {
        dataController && (
          <section class="mb-8 rounded-lg bg-base-50 p-8">
            <h2 class="mb-4 text-sm font-bold uppercase tracking-wide text-base-content/60">
              Data Controller Identification
            </h2>

            <div class="space-y-4 text-sm leading-relaxed text-base-content/70">
              <p>
                For the purposes of the UK General Data Protection Regulation
                (UK GDPR) and the Data Protection Act 2018, the Data Controller
                is:
              </p>

              <div class="space-y-1">
                <div class="font-bold text-base-content">
                  {dataController.name}
                </div>
                <div>A company registered in {dataController.registeredIn}</div>
                <div>
                  Email:{" "}
                  <a
                    href={`mailto:${dataController.email}`}
                    class="text-primary hover:underline">
                    {dataController.email}
                  </a>
                </div>
              </div>

              <div class="pt-3">
                <div class="mb-1 text-xs font-bold uppercase tracking-wide text-base-content">
                  UK Representative for GDPR Purposes
                </div>
                <div>{dataController.ukRep}</div>
                <div>{dataController.ukRepAddress}</div>
              </div>
            </div>
          </section>
        )
      }

      <!-- Table of Contents -->
      <section class="mb-12">
        <details
          class="group rounded-lg border border-base-200 bg-white p-6 shadow-sm">
          <summary
            class="flex cursor-pointer items-center justify-between text-base font-bold text-base-content">
            <span>Table of Contents</span>
            <svg
              class="h-5 w-5 transition-transform group-open:rotate-180"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
        </details>
      </section>

      <!-- Main Content -->
      <article class="mb-16">
        <!-- Section 1: Data Collection -->
        <h2 class="mb-6 text-2xl font-bold text-primary">1. Data Collection</h2>
        <p class="mb-4 leading-relaxed text-base-content/70">
          We collect data to facilitate the connection between consumers and
          locksmiths. The data collected depends on your interaction with our
          platform:
        </p>

        <h3 class="mb-3 mt-6 text-lg font-bold text-base-content">
          Website Visitors
        </h3>
        <p class="mb-4 leading-relaxed text-base-content/70">
          We collect technical data including IP address, browser type,
          operating system, and interaction data via cookies to ensure site
          security and performance.
        </p>

        <h3 class="mb-3 mt-6 text-lg font-bold text-base-content">Consumers</h3>
        <p class="mb-4 leading-relaxed text-base-content/70">
          When you use our routing tools, we may process your partial postcode,
          phone number, and call metadata (time and duration of call to Service
          Providers) to enable service connection.
        </p>

        <h3 class="mb-3 mt-6 text-lg font-bold text-base-content">
          Locksmith Partners
        </h3>
        <p class="mb-4 leading-relaxed text-base-content/70">
          We collect business verification documents including DBS checks,
          insurance certificates, trading addresses, and billing information.
        </p>

        <hr class="my-12 border-base-200" />

        <!-- Section 2: Legal Bases -->
        <h2 class="mb-6 text-2xl font-bold text-primary">
          2. Legal Bases for Processing
        </h2>
        <p class="mb-4 leading-relaxed text-base-content/70">
          Under UK GDPR, we rely on the following legal bases to process your
          personal data:
        </p>

        <div class="space-y-4">
          <div class="rounded-lg bg-base-50 p-6">
            <h3 class="mb-2 text-base font-bold text-base-content">
              Contractual Necessity
            </h3>
            <p class="text-sm text-base-content/70">
              Processing required to fulfil our terms of service, such as
              routing your call to a local locksmith or managing a locksmith's
              business listing.
            </p>
          </div>

          <div class="rounded-lg bg-base-50 p-6">
            <h3 class="mb-2 text-base font-bold text-base-content">
              Legitimate Interests
            </h3>
            <p class="text-sm text-base-content/70">
              Processing necessary for fraud prevention, network security, and
              maintaining the integrity of our directory.
            </p>
          </div>
        </div>

        <hr class="my-12 border-base-200" />

        <!-- Section 3: International Data Transfers -->
        <h2 class="mb-6 text-2xl font-bold text-primary">
          3. International Data Transfers
        </h2>

        <div class="mb-6 rounded-lg border-l-4 border-warning bg-warning/5 p-6">
          <h3 class="mb-3 text-base font-bold text-base-content">
            Important Notice: Data Storage Location
          </h3>
          <p class="text-sm leading-relaxed text-base-content/70">
            Visible Solutions LLC is based in the United States. Your data will
            be transferred to and processed on servers located in the United
            States.
          </p>
        </div>

        <p class="mb-4 leading-relaxed text-base-content/70">
          We acknowledge that the United States has different data protection
          laws than the United Kingdom. To ensure your data remains protected to
          UK standards, we utilize the following safeguards:
        </p>

        <h3 class="mb-3 mt-6 text-lg font-bold text-base-content">
          Standard Contractual Clauses (SCCs)
        </h3>
        <p class="mb-4 leading-relaxed text-base-content/70">
          We implement the UK International Data Transfer Addendum to the EU
          Commission Standard Contractual Clauses for transfers of data to our
          US infrastructure.
        </p>

        <h3 class="mb-3 mt-6 text-lg font-bold text-base-content">
          UK–US Data Bridge
        </h3>
        <p class="mb-4 leading-relaxed text-base-content/70">
          Where applicable, we align our processing activities with the
          principles of the UK-US Data Bridge framework to ensure adequate
          protection.
        </p>

        <hr class="my-12 border-base-200" />

        <!-- Section 4: Your Rights -->
        <h2 class="mb-6 text-2xl font-bold text-primary">4. Your Rights</h2>
        <p class="mb-4 leading-relaxed text-base-content/70">
          You have specific rights regarding your personal data under UK law:
        </p>

        <ul class="mb-4 flex flex-col gap-3">
          <li class="relative list-none pl-8 text-base-content/70">
            <span
              class="absolute left-0 top-0 flex h-5 w-5 items-center justify-center rounded-sm bg-success/10 text-sm font-bold text-success">
              ✓
            </span>
            <strong class="font-bold text-base-content">Right of Access:</strong
            >
            You may request a copy of the personal data we hold about you.
          </li>
          <li class="relative list-none pl-8 text-base-content/70">
            <span
              class="absolute left-0 top-0 flex h-5 w-5 items-center justify-center rounded-sm bg-success/10 text-sm font-bold text-success">
              ✓
            </span>
            <strong class="font-bold text-base-content"
              >Right to Rectification:</strong
            >
            You may ask us to correct data that is inaccurate or incomplete.
          </li>
          <li class="relative list-none pl-8 text-base-content/70">
            <span
              class="absolute left-0 top-0 flex h-5 w-5 items-center justify-center rounded-sm bg-success/10 text-sm font-bold text-success">
              ✓
            </span>
            <strong class="font-bold text-base-content"
              >Right to Erasure:</strong
            >
            Also known as the "Right to be Forgotten," you may ask us to delete your
            data under certain circumstances.
          </li>
          <li class="relative list-none pl-8 text-base-content/70">
            <span
              class="absolute left-0 top-0 flex h-5 w-5 items-center justify-center rounded-sm bg-success/10 text-sm font-bold text-success">
              ✓
            </span>
            <strong class="font-bold text-base-content"
              >Right to Portability:</strong
            >
            You may request to receive your data in a structured, commonly used machine-readable
            format.
          </li>
        </ul>

        <p class="mb-4 leading-relaxed text-base-content/70">
          To exercise any of these rights, please submit a Data Subject Access
          Request (DSAR) via our Contact Page.
        </p>

        <hr class="my-12 border-base-200" />

        <!-- Section 5: Complaints -->
        <h2 class="mb-6 text-2xl font-bold text-primary">5. Complaints</h2>
        <p class="mb-4 leading-relaxed text-base-content/70">
          If you believe we have not processed your data in accordance with the
          law, you have the right to lodge a complaint with the UK Information
          Commissioner's Office (ICO).
        </p>

        <p class="mb-4 leading-relaxed text-base-content/70">
          <strong class="font-bold text-base-content"
            >Information Commissioner's Office</strong
          ><br />
          Wycliffe House, Water Lane<br />
          Wilmslow, Cheshire, SK9 5AF<br />
          Helpline: 0303 123 1113<br />
          Website: <a
            href="http://www.ico.org.uk"
            class="text-primary hover:underline">www.ico.org.uk</a
          >
        </p>

        <hr class="my-12 border-base-200" />

        <!-- Section 6: Data Retention -->
        <h2 class="mb-6 text-2xl font-bold text-primary">6. Data Retention</h2>
        <p class="mb-4 leading-relaxed text-base-content/70">
          We retain your personal data only for as long as necessary to fulfil
          the purposes outlined in this policy or as required by law.
        </p>

        <ul class="mb-4 flex flex-col gap-3">
          <li class="relative list-none pl-8 text-base-content/70">
            <span
              class="absolute left-0 top-0 flex h-5 w-5 items-center justify-center rounded-sm bg-success/10 text-sm font-bold text-success">
              ✓
            </span>
            <strong class="font-bold text-base-content"
              >Consumer Call Data:</strong
            >
            Retained for 12 months for service quality and dispute resolution
          </li>
          <li class="relative list-none pl-8 text-base-content/70">
            <span
              class="absolute left-0 top-0 flex h-5 w-5 items-center justify-center rounded-sm bg-success/10 text-sm font-bold text-success">
              ✓
            </span>
            <strong class="font-bold text-base-content"
              >Website Analytics:</strong
            >
            Retained for 24 months for performance analysis
          </li>
          <li class="relative list-none pl-8 text-base-content/70">
            <span
              class="absolute left-0 top-0 flex h-5 w-5 items-center justify-center rounded-sm bg-success/10 text-sm font-bold text-success">
              ✓
            </span>
            <strong class="font-bold text-base-content"
              >Locksmith Business Data:</strong
            >
            Retained for the duration of their listing plus 6 years for accounting
            purposes
          </li>
        </ul>

        <hr class="my-12 border-base-200" />

        <!-- Section 7: Cookies -->
        <h2 class="mb-6 text-2xl font-bold text-primary">
          7. Cookies and Tracking
        </h2>
        <p class="mb-4 leading-relaxed text-base-content/70">
          We use cookies to improve your experience on our website. You can
          manage your cookie preferences through your browser settings. For more
          information, please see our Cookie Policy.
        </p>

        <hr class="my-12 border-base-200" />

        <!-- Section 8: Changes -->
        <h2 class="mb-6 text-2xl font-bold text-primary">
          8. Changes to This Policy
        </h2>
        <p class="mb-4 leading-relaxed text-base-content/70">
          We may update this Privacy Policy from time to time. We will notify
          you of any significant changes by posting a notice on our website or
          by email if you have provided us with your contact details.
        </p>

        <hr class="my-12 border-base-200" />

        <!-- Section 9: Contact -->
        <h2 class="mb-6 text-2xl font-bold text-primary">9. Contact Us</h2>
        <p class="mb-4 leading-relaxed text-base-content/70">
          If you have any questions about this Privacy Policy or how we handle
          your personal data, please contact us:
        </p>

        <p class="mb-4 leading-relaxed text-base-content/70">
          <strong class="font-bold text-base-content">Email:</strong>
          <a
            href="mailto:privacy@uklocksmithdirectory.co.uk"
            class="text-primary hover:underline"
            >privacy@uklocksmithdirectory.co.uk</a
          ><br />
          <strong class="font-bold text-base-content">Phone:</strong> [Contact Number]<br
          />
          <strong class="font-bold text-base-content">Address:</strong> [Registered
          Office Address]
        </p>
      </article>
    </div>
  </main>
</Layout>
